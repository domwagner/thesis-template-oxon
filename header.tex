%%%%%%%%%%%%%%%%%%%%%%%%%%
%% BEGIN {Introduced by Luke}

\input{style/comment}
\usepackage[normalem]{ulem} % \sout{...} - strike out; added by Luke
\newcommand\defeq{\coloneqq}
\renewcommand\phi{\varphi}
\newcommand\set[1]{\{{#1}\}}
%\usepackage{appendix}
%% END {introduced by Luke}
%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[british,UKenglish]{babel}
\usepackage[T1]{fontenc}
\usepackage{stmaryrd}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{thmtools,thm-restate}
\usepackage{tabularx}
%\usepackage{MnSymbol}
% \usepackage[ruled,vlined]{algorithm2e}
%\usepackage{float}
\usepackage{proof}
\usepackage{xcolor}
\definecolor{oxblue}{RGB}{0,33,71}
\definecolor{oxlightblue}{RGB}{0,72,205}
\definecolor{oxlightblue2}{RGB}{161,196,208}
\definecolor{oxgold}{HTML}{a0630a%ac6a0a%b9720b%cc7e0c%e88f0e% 9e8340
}
\definecolor{oxyellow}{RGB}{243,222,116}
\definecolor{oxbrown}{HTML}{88562e}%153,101,21}
\definecolor{oxgreen}{HTML}{3e6111}%558618}
\definecolor{oxgreen2}{RGB}{105,145,59}
\definecolor{oxgreen3}{RGB}{185,207,150}

\definecolor{oxred}{HTML}{ac0b1d}%960a2c}
\definecolor{oxred2}{RGB}{190,15,52}
\definecolor{oxpink}{RGB}{235,196,203}
\definecolor{oxorange}{RGB}{207,122,48}

\definecolor{oxgrey}{RGB}{167,157,150}


\newcommand\defiff{\mathrel{\vcentcolon\Longleftrightarrow}}

\usepackage{listings}
\lstset{language=haskell, keywordstyle={\bfseries\color{oxblue}},morekeywords={rec}}
\usepackage{stackengine}

\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta, decorations.pathreplacing, shadows}


\newcommand{\lchapter}[2][]{\chapter{#2}\chaptermark{#1}}


\newcommand\biglor{\bigvee}
\newcommand\bigland{\bigwedge}
\newcommand\cint[1]{\mathcal C\llbracket#1\rrbracket}
\newcommand\cintip[2]{\mathcal C^+_{#1}\llbracket#2\rrbracket}
\newcommand\inter[1]{\mathcal S\llbracket#1\rrbracket}
\newcommand\interi[2]{\mathcal S_{#1}\llbracket#2\rrbracket}
\newcommand\interip[2]{\mathcal S^+_{#1}\llbracket#2\rrbracket}
\newcommand\interp[1]{\mathcal S^+\llbracket#1\rrbracket}
\newcommand\minti[2]{\mathcal M_{#1}\llbracket#2\rrbracket}
\newcommand\sinti[2]{{#1}\llbracket#2\rrbracket}
\newcommand\hinti[2]{{#1}^\Hf\llbracket#2\rrbracket}
\newcommand\cinti[2]{#1^C\llbracket#2\rrbracket}
\newcommand\restr[1]{_{|#1}}
\newcommand{\from}{:}
\newcommand{\As}{\mathcal A}
\newcommand{\Bs}{\mathcal B}
\newcommand{\Hs}{\mathcal H}
\newcommand{\Hf}{\mathcal H}
\newcommand{\Sf}{\mathcal S}
\newcommand{\Mf}{\mathcal M}
\newcommand{\Cf}{\mathcal C}
\newcommand{\Ad}{\mathfrak A}
\newcommand{\Bd}{\mathfrak B}
\newcommand{\Hd}{\mathfrak H}
\newcommand{\Rd}{\mathfrak R}
\newcommand{\Sd}{\mathfrak S}
\newcommand{\Td}{\mathfrak T}
\newcommand{\igt}{\mathrm{gt}_\iota}
\newcommand{\dA}{\dom(\As)}
\newcommand{\dB}{\dom(\Bs)}
\newcommand\dec[1]{{D(\As,\mathfrak{#1})}}
\newcommand\nat{\mathbb N}
\newcommand\bool{\mathbb B}
\newcommand\nin{\not\in}
\newcommand\mrel{\sqsubseteq_m}
\newcommand\mrelrev{\sqsupseteq_m}
\newcommand\crel{\sqsubseteq_c}
\newcommand\crelrev{\sqsupseteq_c}
\newcommand\prel{\sqsubseteq}
\newcommand\arel{\precsim}
\newcommand\indnl{\\[16pt]}

\DeclareMathOperator{\argmax}{arg\, max}
\DeclareMathOperator{\argmin}{arg\, min}
\DeclareMathOperator{\HoCHC}{HoCHC}
\DeclareMathOperator{\HoCC}{HoCC}
% \DeclareMathOperator{\id}{id}
\DeclareMathOperator{\dir}{dir}
\DeclareMathOperator{\nf}{NF}
\DeclareMathOperator{\nfd}{-NF}
\DeclareMathOperator{\dnf}{DNF}
\DeclareMathOperator{\cnf}{CNF}
\DeclareMathOperator{\lf}{-LF}
\DeclareMathOperator{\prenex}{prenex}
% \DeclareMathOperator{\defihelp}{def}
\DeclareMathOperator{\elimhelp}{elim}
\DeclareMathOperator{\free}{fv}
\DeclareMathOperator{\vars}{vars}
\DeclareMathOperator{\depth}{depth}
\DeclareMathOperator{\const}{const}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\true}{true}
\DeclareMathOperator{\false}{false}
\DeclareMathOperator{\types}{types}
\DeclareMathOperator{\andf}{and}
\DeclareMathOperator{\orf}{or}
\DeclareMathOperator{\cexists}{cexists}
\DeclareMathOperator{\hexistsh}{exists}
\DeclareMathOperator{\lfp}{lfp}
\DeclareMathOperator{\On}{\mathbf{On}}
\DeclareMathOperator{\Lim}{\mathbf{Lim}}
\DeclareMathOperator{\LIA}{LIA}
\DeclareMathOperator{\Her}{Her}
\DeclareMathOperator{\PA}{PA}
\DeclareMathOperator{\FO}{{FO}}
\DeclareMathOperator{\Resh}{Res}
\DeclareMathOperator{\Reshh}{Res-C}
\DeclareMathOperator{\FOResh}{{FO-Res}}
\DeclareMathOperator{\Eq}{Eq}
\DeclareMathOperator{\Imp}{Imp}
\DeclareMathOperator{\All}{All}
\DeclareMathOperator{\App}{App}
\DeclareMathOperator{\app}{@}
\DeclareMathOperator{\diff}{diff}
\DeclareMathOperator{\comp}{comp}
\DeclareMathOperator{\posex}{posex}
\DeclareMathOperator{\nega}{neg}
\DeclareMathOperator{\Comp}{Comp}
\DeclareMathOperator{\Equiv}{Equiv}
\DeclareMathOperator{\Neg}{Neg}
\DeclareMathOperator{\inc}{inc}
\DeclareMathOperator{\test}{test\&dec}
\DeclareMathOperator{\Iter}{Iter}
\DeclareMathOperator{\Iterb}{\mathbf{Iter}}
\DeclareMathOperator{\Add}{Add}
\DeclareMathOperator{\Twice}{Twice}
\DeclareMathOperator{\Addb}{\mathbf{Add}}


\newcommand{\elim}{\elimhelp_\lambda}
% \newcommand{\defi}{\defihelp_\lambda}
\newcommand{\hexists}{\hexistsh}

\newcommand{\xtwoheadrightarrow}[2][]{
  \xrightarrow[#1]{#2}\mathrel{\mkern-14mu}\rightarrow
}

\stackMath
\newcommand\xxrightarrow[2][]{\mathrel{%
  \setbox2=\hbox{\stackon{\scriptstyle#1}{\scriptstyle#2}}%
  \stackunder[0pt]{%
    \xrightarrow{\makebox[\dimexpr\wd2\relax]{$\scriptstyle#2$}}%
  }{%
   \scriptstyle#1\,%
  }%
}}
\newcommand\xxtwoheadrightarrow[2][]{\mathrel{%
  \setbox2=\hbox{\stackon{\scriptstyle#1}{\scriptstyle#2}}%
  \stackunder[0pt]{%
    \xtwoheadrightarrow{\makebox[\dimexpr\wd2\relax]{$\scriptstyle#2$}}%
  }{%
   \scriptstyle#1\,%
  }%
}}
\parskip 3pt

% \newcommand{\myrightarrow}[2]{\xrightarrow[#1]{#2}}
% \newcommand{\mytwoheadrightarrow}[2]{\xtwoheadrightarrow[#1]{#2}}

\newcommand{\lred}[1]{\xxrightarrow[\ell]{#1}}
\newcommand{\lredrt}{\xxtwoheadrightarrow[\ell]{}}
\newcommand{\sred}{\xxrightarrow[s]{}}
\newcommand{\bured}{\rightarrow_{\beta\upsilon}}
\newcommand{\buredrt}{\twoheadrightarrow_{\beta\upsilon}}
\newcommand{\bred}{\rightarrow_\beta}
\newcommand{\bredrt}{\twoheadrightarrow_\beta}
\newcommand{\ured}{\rightarrow_\upsilon}
\newcommand{\pred}{\rightarrow_\parallel}

\newcommand{\force}{\vartriangleright}

\newcommand{\Res}{\Rightarrow_{\Resh}}
\newcommand{\FORes}{\Rightarrow_{\FOResh}}

\newcommand\mref[1]{Mismatch \ref{#1}}
\newcommand\sref[1]{Proof Step \ref{#1}}
\newcommand\srefs[2]{Proof Steps \ref{#1} and \ref{#2}}

\newcommand\btypes{\mathfrak I}


% Calculus Rules
\newcommand{\shortrule}[4]{\noindent\begin{minipage}{10ex}{\bfseries
      #1}\end{minipage} $\qquad$ #2 $\quad\Rightarrow\quad$
  #3 \par\smallskip\noindent #4}
\newcommand{\longnamerule}[4]{\noindent{\bfseries #1}\newline \hspace*{3ex} #2 $\quad\Rightarrow\quad$ #3 \par\smallskip\noindent #4}
\newcommand{\shortrules}[6]{\noindent\begin{minipage}{#6ex}{\bfseries #1}\end{minipage} $\;$ #2 $\;\Rightarrow_{\text{#5}}\;$ #3 \par\smallskip\noindent #4} 
\newcommand{\longnamerules}[5]{\noindent{\bfseries #1}\newline \hspace*{3ex} #2 $\;\Rightarrow_{\text{#5}}\;$ #3 \par\smallskip\noindent #4} 
\newcommand{\ruleset}[4]{\noindent\begin{minipage}{#1} \flushright #3 \end{minipage} $\quad \Rightarrow_{\text{#2}}\quad$ #4}

\newcommand{\inferbin}[5]{\bigskip\begin{minipage}{32ex}{\bfseries #1}\end{minipage} {
    \begin{minipage}{10ex}{$\infer{#4}{#2 &&& #3}$}\end{minipage}
    \par\medskip\noindent #5}}
\newcommand{\inferun}[4]{\bigskip\begin{minipage}{32ex}{\bfseries #1}\end{minipage} {
    \begin{minipage}{10ex}{$\infer{#3}{#2}$}\end{minipage}
    \par\medskip\noindent #4}}
\newcommand{\inferann}[5]{\bigskip\begin{minipage}{32ex}{\bfseries #1}\end{minipage} {
    \begin{minipage}{10ex}{$\infer[#3]{#4}{#2}$}\end{minipage}
    \par\medskip\noindent #5}}

\newcommand{\stkout}[1]{\ifmmode\text{\sout{\ensuremath{#1}}}\else\sout{#1}\fi}

\newcommand{\Set}{\Gamma}
\newcommand{\Prgm}{\Pi}
\renewcommand{\Hf}{\mathcal F}
